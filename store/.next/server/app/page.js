(()=>{var e={};e.id=931,e.ids=[931],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},8629:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>s.a,__next_app__:()=>c,originalPathname:()=>x,pages:()=>p,routeModule:()=>g,tree:()=>d});var i=r(7),n=r(8533),o=r(9377),s=r.n(o),l=r(9799),a={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(a[e]=()=>l[e]);r.d(t,a);let d=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,3214)),"/Users/mocky700/Desktop/デミセル/store/app/page.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,9224)),"/Users/mocky700/Desktop/デミセル/store/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,3472,23)),"next/dist/client/components/not-found-error"]}],p=["/Users/mocky700/Desktop/デミセル/store/app/page.tsx"],x="/page",c={require:r,loadChunk:()=>Promise.resolve()},g=new i.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},9308:(e,t,r)=>{Promise.resolve().then(r.bind(r,5497))},1036:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var i=r(4714),n=r(128),o=r.n(n);function s(){return(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px"},className:"jsx-ff161281ed666c63",children:[i.jsx("div",{style:{width:"40px",height:"40px",border:"4px solid #f3f3f3",borderTop:"4px solid #5DABA8",borderRadius:"50%",animation:"spin 1s linear infinite"},className:"jsx-ff161281ed666c63"}),i.jsx(o(),{id:"ff161281ed666c63",children:"@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes spin{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes spin{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}"})]})}},5497:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>k});var i=r(4714),n=r(7580),o=r(466);async function s(){try{let{data:{user:e},error:t}=await o.O.auth.getUser();if(t)return console.error("Error getting user:",t),null;return e}catch(e){return console.error("Error getting user:",e),null}}async function l(e,t){try{let{data:r,error:i}=await o.O.auth.signInWithPassword({email:e,password:t});if(i)throw i;return r}catch(e){throw console.error("Error signing in:",e),e}}async function a(e,t){try{let{data:r,error:i}=await o.O.auth.signUp({email:e,password:t});if(i)throw i;return r}catch(e){throw console.error("Error signing up:",e),e}}async function d(){try{let{data:e,error:t}=await o.O.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/auth/callback`}});if(t)throw t;return e}catch(e){throw console.error("Error signing in with Google:",e),e}}function p(){let[e,t]=(0,n.useState)(!0),[r,o]=(0,n.useState)(""),[s,p]=(0,n.useState)(""),[x,c]=(0,n.useState)(""),[g,u]=(0,n.useState)(!1),h=async t=>{t.preventDefault(),c(""),u(!0);try{e?await l(r,s):await a(r,s)}catch(e){c(e.message||"認証に失敗しました")}finally{u(!1)}},m=async()=>{c(""),u(!0);try{await d()}catch(e){c(e.message||"Google認証に失敗しました"),u(!1)}};return i.jsx("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"20px",backgroundColor:"#f5f5f5"},children:(0,i.jsxs)("div",{style:{width:"100%",maxWidth:"400px",backgroundColor:"white",borderRadius:"12px",padding:"30px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)"},children:[i.jsx("h1",{style:{fontSize:"24px",fontWeight:"bold",textAlign:"center",marginBottom:"30px",color:"#333"},children:"出店者向けプラットフォーム"}),(0,i.jsxs)("div",{style:{display:"flex",marginBottom:"20px",borderBottom:"1px solid #e0e0e0"},children:[i.jsx("button",{onClick:()=>{t(!0),c("")},style:{flex:1,padding:"12px",border:"none",backgroundColor:"transparent",borderBottom:e?"2px solid #5DABA8":"none",color:e?"#5DABA8":"#666",fontWeight:e?"bold":"normal",cursor:"pointer",fontSize:"16px"},children:"ログイン"}),i.jsx("button",{onClick:()=>{t(!1),c("")},style:{flex:1,padding:"12px",border:"none",backgroundColor:"transparent",borderBottom:e?"none":"2px solid #5DABA8",color:e?"#666":"#5DABA8",fontWeight:e?"normal":"bold",cursor:"pointer",fontSize:"16px"},children:"新規登録"})]}),x&&i.jsx("div",{style:{padding:"12px",backgroundColor:"#fee",color:"#c33",borderRadius:"4px",marginBottom:"20px",fontSize:"14px"},children:x}),(0,i.jsxs)("form",{onSubmit:h,children:[(0,i.jsxs)("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#333"},children:"メールアドレス"}),i.jsx("input",{type:"email",value:r,onChange:e=>o(e.target.value),required:!0,style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"16px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#333"},children:"パスワード"}),i.jsx("input",{type:"password",value:s,onChange:e=>p(e.target.value),required:!0,minLength:6,style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"16px"}})]}),i.jsx("button",{type:"submit",disabled:g,style:{width:"100%",padding:"12px",backgroundColor:g?"#ccc":"#5DABA8",color:"white",border:"none",borderRadius:"4px",fontSize:"16px",fontWeight:"bold",cursor:g?"not-allowed":"pointer",marginBottom:"16px"},children:g?"処理中...":e?"ログイン":"新規登録"})]}),i.jsx("div",{style:{textAlign:"center",margin:"20px 0",color:"#999",fontSize:"14px"},children:"または"}),(0,i.jsxs)("button",{onClick:m,disabled:g,style:{width:"100%",padding:"12px",backgroundColor:"white",color:"#333",border:"1px solid #ddd",borderRadius:"4px",fontSize:"16px",fontWeight:"500",cursor:g?"not-allowed":"pointer",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[i.jsx("span",{children:"\uD83D\uDD0D"}),"Googleで",e?"ログイン":"登録"]}),(0,i.jsxs)("button",{onClick:()=>{c(""),window.location.href="/api/auth/line-login"},disabled:g,style:{width:"100%",padding:"12px",backgroundColor:"#06C755",color:"white",border:"none",borderRadius:"4px",fontSize:"16px",fontWeight:"bold",cursor:g?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[i.jsx("span",{children:"\uD83D\uDCAC"}),"LINEで",e?"ログイン":"登録"]})]})})}var x=r(8934);async function c(e,t,r){try{let{data:i,error:n}=await o.O.storage.from(e).upload(t,r,{cacheControl:"3600",upsert:!1});if(n)throw n;let{data:s}=o.O.storage.from(e).getPublicUrl(i.path);return s.publicUrl}catch(e){throw console.error("Error uploading image:",e),e}}function g({currentStep:e,totalSteps:t}){let r=e/t*100;return(0,i.jsxs)("div",{style:{width:"100%",marginBottom:"20px"},children:[i.jsx("div",{style:{width:"100%",height:"8px",backgroundColor:"#e0e0e0",borderRadius:"4px",overflow:"hidden"},children:i.jsx("div",{style:{width:`${r}%`,height:"100%",backgroundColor:"#5DABA8",transition:"width 0.3s ease"}})}),(0,i.jsxs)("div",{style:{textAlign:"center",marginTop:"8px",fontSize:"14px",color:"#666"},children:[e," / ",t]})]})}var u=r(128),h=r.n(u);function m({imageUrl:e,documentType:t,onRecognized:r}){let[o,s]=(0,n.useState)(!1),[l,a]=(0,n.useState)(null),[d,p]=(0,n.useState)(""),x=async()=>{if(!e){p("画像が選択されていません");return}s(!0),p(""),a(null);try{let i=await fetch("/api/ocr/recognize-document",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageUrl:e,documentType:t})}),n=await i.json();if(!i.ok)throw Error(n.error||"認識に失敗しました");a(n.data),r(n.data)}catch(e){p(e.message||"画像認識に失敗しました")}finally{s(!1)}};return(0,i.jsxs)("div",{style:{marginTop:"12px"},className:"jsx-ff161281ed666c63",children:[i.jsx("button",{onClick:x,disabled:o||!e,style:{padding:"8px 16px",backgroundColor:o?"#ccc":"#5DABA8",color:"white",border:"none",borderRadius:"4px",fontSize:"14px",cursor:o||!e?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px"},className:"jsx-ff161281ed666c63",children:o?(0,i.jsxs)(i.Fragment,{children:[i.jsx("span",{className:"jsx-ff161281ed666c63",children:"認識中..."}),i.jsx("div",{style:{width:"16px",height:"16px",border:"2px solid #fff",borderTop:"2px solid transparent",borderRadius:"50%",animation:"spin 1s linear infinite"},className:"jsx-ff161281ed666c63"})]}):(0,i.jsxs)(i.Fragment,{children:[i.jsx("span",{className:"jsx-ff161281ed666c63",children:"\uD83D\uDD0D"}),(0,i.jsxs)("span",{className:"jsx-ff161281ed666c63",children:[{businessLicense:"営業許可証",vehicleInspection:"車検証",automobileInspection:"自賠責保険",plInsurance:"PL保険"}[t]||"書類","を認識"]})]})}),d&&i.jsx("div",{style:{marginTop:"8px",padding:"8px",backgroundColor:"#fee",color:"#c33",borderRadius:"4px",fontSize:"12px"},className:"jsx-ff161281ed666c63",children:d}),l&&(0,i.jsxs)("div",{style:{marginTop:"12px",padding:"12px",backgroundColor:"#f0f8ff",borderRadius:"4px",fontSize:"14px"},className:"jsx-ff161281ed666c63",children:[i.jsx("div",{style:{fontWeight:"bold",marginBottom:"8px"},className:"jsx-ff161281ed666c63",children:"認識結果:"}),i.jsx("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",fontSize:"12px",margin:0},className:"jsx-ff161281ed666c63",children:JSON.stringify(l,null,2)})]}),i.jsx(h(),{id:"ff161281ed666c63",children:"@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes spin{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes spin{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}"})]})}function f({label:e,value:t,onChange:r,onFileSelect:o,required:s=!1,enableOCR:l=!1,documentType:a,onRecognized:d}){let[p,x]=(0,n.useState)(t||null),[c,g]=(0,n.useState)(!1),u=e=>{let t=e.target.files?.[0];if(!t)return;let r=new FileReader;r.onloadend=()=>{x(r.result)},r.readAsDataURL(t),o(t)};return(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsxs)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500",color:"#333"},children:[e,s&&i.jsx("span",{style:{color:"#e74c3c"},children:" *"})]}),i.jsx("div",{style:{border:"2px dashed #ccc",borderRadius:"8px",padding:"20px",textAlign:"center",backgroundColor:"#f9f9f9"},children:p?(0,i.jsxs)("div",{children:[i.jsx("img",{src:p,alt:"Preview",style:{maxWidth:"100%",maxHeight:"200px",marginBottom:"10px",borderRadius:"4px"}}),i.jsx("div",{children:(0,i.jsxs)("label",{style:{display:"inline-block",padding:"8px 16px",backgroundColor:"#5DABA8",color:"white",borderRadius:"4px",cursor:"pointer",fontSize:"14px"},children:["画像を変更",i.jsx("input",{type:"file",accept:"image/*",onChange:u,style:{display:"none"},disabled:c})]})})]}):(0,i.jsxs)("label",{style:{display:"block",cursor:"pointer"},children:[i.jsx("div",{style:{fontSize:"48px",color:"#999",marginBottom:"10px"},children:"\uD83D\uDCF7"}),i.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"10px"},children:"画像を選択"}),i.jsx("div",{style:{fontSize:"12px",color:"#999"},children:"JPG, PNG, GIF (最大 5MB)"}),i.jsx("input",{type:"file",accept:"image/*",onChange:u,style:{display:"none"},disabled:c})]})}),c&&i.jsx("div",{style:{marginTop:"10px",fontSize:"14px",color:"#666"},children:"アップロード中..."}),l&&p&&a&&i.jsx(m,{imageUrl:p,documentType:a,onRecognized:e=>{d&&d(e)}})]})}var y=r(1036);function b(){let e=(0,x.useRouter)(),[t,r]=(0,n.useState)(1),[l,a]=(0,n.useState)(!1),[d,p]=(0,n.useState)(""),[u,h]=(0,n.useState)({name:"",gender:"",age:"",phoneNumber:"",email:"",genreCategory:"",genreFreeText:"",businessLicenseImage:null,vehicleInspectionImage:null,automobileInspectionImage:null,plInsuranceImage:null,fireEquipmentLayoutImage:null});(0,n.useEffect)(()=>{let e=sessionStorage.getItem("exhibitor_draft");if(e)try{let t=JSON.parse(e);h(e=>({...e,...t}))}catch(e){console.error("Failed to load draft:",e)}},[]);let m=()=>{let e={name:u.name,gender:u.gender,age:u.age,phoneNumber:u.phoneNumber,email:u.email,genreCategory:u.genreCategory,genreFreeText:u.genreFreeText};sessionStorage.setItem("exhibitor_draft",JSON.stringify(e))},b=(e,t)=>{h(r=>({...r,[e]:t})),m()},j=(e,t)=>{h(r=>({...r,[e]:t}))},v=()=>u.name&&u.gender&&u.age&&u.phoneNumber&&u.email?!(isNaN(Number(u.age))||0>Number(u.age))||(p("年齢は正の数で入力してください"),!1):(p("すべての必須項目を入力してください"),!1),S=async()=>{p(""),a(!0);try{let t=await s();if(!t)throw Error("認証されていません");let r=[],i={};for(let e of["businessLicenseImage","vehicleInspectionImage","automobileInspectionImage","plInsuranceImage","fireEquipmentLayoutImage"]){let n=u[e];if(n){let o=`exhibitors/${t.id}/${e}_${Date.now()}.${n.name.split(".").pop()}`;r.push(c("documents",o,n).then(t=>(i[e.replace("Image","ImageUrl")]=t,t)))}}await Promise.all(r);let{error:n}=await o.O.from("exhibitors").insert({user_id:t.id,name:u.name,gender:u.gender,age:parseInt(u.age),phone_number:u.phoneNumber,email:u.email,genre_category:u.genreCategory||null,genre_free_text:u.genreFreeText||null,business_license_image_url:i.businessLicenseImageUrl||null,vehicle_inspection_image_url:i.vehicleInspectionImageUrl||null,automobile_inspection_image_url:i.automobileInspectionImageUrl||null,pl_insurance_image_url:i.plInsuranceImageUrl||null,fire_equipment_layout_image_url:i.fireEquipmentLayoutImageUrl||null});if(n)throw n;sessionStorage.removeItem("exhibitor_draft"),e.push("/")}catch(e){p(e.message||"登録に失敗しました")}finally{a(!1)}};return l?i.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx(y.Z,{})}):i.jsx("div",{style:{minHeight:"100vh",padding:"20px",backgroundColor:"#f5f5f5"},children:(0,i.jsxs)("div",{style:{maxWidth:"600px",margin:"0 auto",backgroundColor:"white",borderRadius:"12px",padding:"30px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)"},children:[i.jsx("h1",{style:{fontSize:"24px",fontWeight:"bold",marginBottom:"20px",textAlign:"center"},children:"出店者情報登録"}),i.jsx(g,{currentStep:t,totalSteps:3}),d&&i.jsx("div",{style:{padding:"12px",backgroundColor:"#fee",color:"#c33",borderRadius:"4px",marginBottom:"20px",fontSize:"14px"},children:d}),1===t&&(0,i.jsxs)("div",{children:[i.jsx("h2",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"20px"},children:"基本情報"}),(0,i.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,i.jsxs)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:["名前 ",i.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),i.jsx("input",{type:"text",value:u.name,onChange:e=>b("name",e.target.value),required:!0,style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"16px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,i.jsxs)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:["性別 ",i.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),(0,i.jsxs)("select",{value:u.gender,onChange:e=>b("gender",e.target.value),required:!0,style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"16px"},children:[i.jsx("option",{value:"",children:"選択してください"}),i.jsx("option",{value:"男",children:"男"}),i.jsx("option",{value:"女",children:"女"}),i.jsx("option",{value:"それ以外",children:"それ以外"})]})]}),(0,i.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,i.jsxs)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:["年齢 ",i.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),i.jsx("input",{type:"number",value:u.age,onChange:e=>b("age",e.target.value),required:!0,min:"0",style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"16px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,i.jsxs)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:["電話番号 ",i.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),i.jsx("input",{type:"tel",value:u.phoneNumber,onChange:e=>b("phoneNumber",e.target.value),required:!0,style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"16px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,i.jsxs)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:["メールアドレス ",i.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),i.jsx("input",{type:"email",value:u.email,onChange:e=>b("email",e.target.value),required:!0,style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"16px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"ジャンル（カテゴリ）"}),i.jsx("input",{type:"text",value:u.genreCategory,onChange:e=>b("genreCategory",e.target.value),placeholder:"例: 飲食、雑貨、アート",style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"16px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"ジャンル（自由記述）"}),i.jsx("textarea",{value:u.genreFreeText,onChange:e=>b("genreFreeText",e.target.value),placeholder:"ジャンルの詳細を記入してください",rows:4,style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"16px",fontFamily:"inherit"}})]})]}),2===t&&(0,i.jsxs)("div",{children:[i.jsx("h2",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"20px"},children:"書類アップロード"}),i.jsx(f,{label:"営業許可証",onFileSelect:e=>j("businessLicenseImage",e),enableOCR:!0,documentType:"businessLicense",onRecognized:e=>{console.log("営業許可証認識結果:",e)}}),i.jsx(f,{label:"車検証",onFileSelect:e=>j("vehicleInspectionImage",e),enableOCR:!0,documentType:"vehicleInspection",onRecognized:e=>{console.log("車検証認識結果:",e)}}),i.jsx(f,{label:"自賠責保険",onFileSelect:e=>j("automobileInspectionImage",e),enableOCR:!0,documentType:"automobileInspection",onRecognized:e=>{console.log("自賠責保険認識結果:",e)}}),i.jsx(f,{label:"PL保険",onFileSelect:e=>j("plInsuranceImage",e),enableOCR:!0,documentType:"plInsurance",onRecognized:e=>{console.log("PL保険認識結果:",e)}}),i.jsx(f,{label:"消防設備配置図",onFileSelect:e=>j("fireEquipmentLayoutImage",e)})]}),3===t&&(0,i.jsxs)("div",{children:[i.jsx("h2",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"20px"},children:"利用規約確認"}),(0,i.jsxs)("div",{style:{padding:"20px",backgroundColor:"#f9f9f9",borderRadius:"8px",marginBottom:"20px",maxHeight:"400px",overflowY:"auto"},children:[i.jsx("h3",{style:{fontSize:"16px",fontWeight:"bold",marginBottom:"12px"},children:"利用規約"}),(0,i.jsxs)("div",{style:{fontSize:"14px",lineHeight:"1.6",color:"#666"},children:[i.jsx("p",{style:{marginBottom:"12px"},children:"本サービスをご利用いただくにあたり、以下の利用規約に同意していただく必要があります。"}),i.jsx("p",{style:{marginBottom:"12px"},children:"1. 出店者は、提供する情報が正確であることを保証します。"}),i.jsx("p",{style:{marginBottom:"12px"},children:"2. 出店者は、必要な書類を適切に提出する責任があります。"}),i.jsx("p",{style:{marginBottom:"12px"},children:"3. 主催者は、出店者の申請を承認または却下する権利を有します。"}),i.jsx("p",{style:{marginBottom:"12px"},children:"4. 個人情報は適切に管理され、本サービスの目的のみに使用されます。"})]})]}),(0,i.jsxs)("label",{style:{display:"flex",alignItems:"center",marginBottom:"20px",cursor:"pointer"},children:[i.jsx("input",{type:"checkbox",required:!0,style:{marginRight:"8px",width:"20px",height:"20px"}}),(0,i.jsxs)("span",{style:{fontSize:"14px"},children:["利用規約に同意します ",i.jsx("span",{style:{color:"#e74c3c"},children:"*"})]})]})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"12px",marginTop:"30px"},children:[t>1&&i.jsx("button",{onClick:()=>{p(""),t>1&&r(t-1)},style:{flex:1,padding:"12px",backgroundColor:"#f0f0f0",color:"#333",border:"none",borderRadius:"4px",fontSize:"16px",fontWeight:"500",cursor:"pointer"},children:"戻る"}),t<3?i.jsx("button",{onClick:()=>{p(""),1===t?v()&&r(2):2===t&&r(3)},style:{flex:1,padding:"12px",backgroundColor:"#5DABA8",color:"white",border:"none",borderRadius:"4px",fontSize:"16px",fontWeight:"bold",cursor:"pointer"},children:"次へ"}):i.jsx("button",{onClick:S,style:{flex:1,padding:"12px",backgroundColor:"#5DABA8",color:"white",border:"none",borderRadius:"4px",fontSize:"16px",fontWeight:"bold",cursor:"pointer"},children:"登録する"})]})]})})}function j({event:e,onClick:t}){let r=e=>{let t=new Date(e);return`${t.getMonth()+1}/${t.getDate()}`};return(0,i.jsxs)("div",{onClick:t,style:{backgroundColor:"white",borderRadius:"8px",overflow:"hidden",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",cursor:"pointer",transition:"transform 0.2s"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)"},children:[e.main_image_url&&i.jsx("div",{style:{width:"100%",height:"200px",backgroundImage:`url(${e.main_image_url})`,backgroundSize:"cover",backgroundPosition:"center"}}),(0,i.jsxs)("div",{style:{padding:"16px"},children:[i.jsx("h3",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"8px",color:"#333"},children:e.event_name}),(0,i.jsxs)("div",{style:{fontSize:"14px",color:"#666",marginBottom:"8px"},children:["\uD83D\uDCC5 ",r(e.event_start_date)," - ",r(e.event_end_date)]}),(0,i.jsxs)("div",{style:{fontSize:"14px",color:"#666",marginBottom:"8px"},children:["\uD83D\uDCCD ",e.venue_name,e.venue_city&&` (${e.venue_city})`]}),e.lead_text&&i.jsx("div",{style:{fontSize:"14px",color:"#999",marginTop:"8px",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:e.lead_text})]})]})}function v(){let[e,t]=(0,n.useState)([]),[r,s]=(0,n.useState)(!0),[l,a]=(0,n.useState)("");(0,n.useEffect)(()=>{d()},[]);let d=async()=>{try{s(!0);let e=new Date().toISOString().split("T")[0],r=o.O.from("events").select("*").or("approval_status.eq.approved,approval_status.is.null").gte("application_end_date",e).order("event_start_date",{ascending:!0}),{data:i,error:n}=await r;if(n){if("PGRST116"===n.code||n.message.includes("column")){let{data:r,error:i}=await o.O.from("events").select("*").gte("application_end_date",e).order("event_start_date",{ascending:!0});if(i)throw i;t(r||[])}else throw n}else t(i||[])}catch(e){console.error("Error loading events:",e),a(e.message||"イベントの読み込みに失敗しました")}finally{s(!1)}},p=e=>{window.location.href=`/event/${e}`};return r?i.jsx("div",{style:{padding:"20px"},children:i.jsx(y.Z,{})}):l?(0,i.jsxs)("div",{style:{padding:"20px",textAlign:"center"},children:[i.jsx("div",{style:{padding:"16px",backgroundColor:"#fee",color:"#c33",borderRadius:"8px",marginBottom:"16px"},children:l}),i.jsx("button",{onClick:d,style:{padding:"12px 24px",backgroundColor:"#5DABA8",color:"white",border:"none",borderRadius:"4px",fontSize:"16px",cursor:"pointer"},children:"再読み込み"})]}):(0,i.jsxs)("div",{style:{minHeight:"100vh",backgroundColor:"#f5f5f5",paddingBottom:"80px"},children:[i.jsx("div",{style:{backgroundColor:"white",padding:"16px",borderBottom:"1px solid #e0e0e0",position:"sticky",top:0,zIndex:100},children:i.jsx("h1",{style:{fontSize:"20px",fontWeight:"bold",color:"#333"},children:"マイイベント"})}),i.jsx("div",{style:{padding:"20px"},children:0===e.length?(0,i.jsxs)("div",{style:{textAlign:"center",padding:"40px 20px",color:"#999"},children:[i.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"\uD83D\uDCC5"}),i.jsx("div",{style:{fontSize:"16px"},children:"現在、申し込み可能なイベントはありません"})]}):i.jsx("div",{style:{display:"grid",gap:"16px"},children:e.map(e=>i.jsx(j,{event:e,onClick:()=>p(e.id)},e.id))})})]})}function S(){let[e,t]=(0,n.useState)([]),[r,s]=(0,n.useState)([]),[l,a]=(0,n.useState)(!0),[d,p]=(0,n.useState)(""),[x,c]=(0,n.useState)(""),[g,u]=(0,n.useState)(""),[h,m]=(0,n.useState)(""),[f,b]=(0,n.useState)(""),[v,S]=(0,n.useState)(""),[_,w]=(0,n.useState)(""),[C,z]=(0,n.useState)(null);(0,n.useEffect)(()=>{k()},[]),(0,n.useEffect)(()=>{B()},[e,x,g,h,f,v,_]);let k=async()=>{try{a(!0);let e=new Date().toISOString().split("T")[0],r=o.O.from("events").select("*").gte("application_end_date",e).order("event_start_date",{ascending:!0}),{data:i,error:n}=await r;if(n)throw n;t(i||[]),s(i||[])}catch(e){console.error("Error loading events:",e),p(e.message||"イベントの読み込みに失敗しました")}finally{a(!1)}},B=()=>{let t=[...e];x&&(t=t.filter(e=>e.event_name.toLowerCase().includes(x.toLowerCase())||e.lead_text?.toLowerCase().includes(x.toLowerCase()))),g&&(t=t.filter(e=>e.event_start_date>=g)),h&&(t=t.filter(e=>e.event_end_date<=h)),f&&(t=t.filter(e=>e.venue_city?.includes(f))),v&&(t=t.filter(e=>e.venue_town?.includes(v)||e.venue_city?.includes(v))),_&&(t=t.filter(e=>e.genre?.includes(_))),s(t)},D=e=>{z(e)},I=async e=>{try{let{data:{user:t}}=await o.O.auth.getUser();if(!t){alert("ログインが必要です");return}let{data:r}=await o.O.from("exhibitors").select("id").eq("user_id",t.id).single();if(!r){alert("出店者情報が登録されていません");return}let{error:i}=await o.O.from("event_applications").insert({exhibitor_id:r.id,event_id:e,application_status:"pending"});if(i)throw i;alert("申し込みが完了しました"),z(null),k()}catch(e){alert(e.message||"申し込みに失敗しました")}};return l?i.jsx("div",{style:{padding:"20px"},children:i.jsx(y.Z,{})}):C?(0,i.jsxs)("div",{style:{minHeight:"100vh",backgroundColor:"#f5f5f5",padding:"20px"},children:[i.jsx("button",{onClick:()=>z(null),style:{marginBottom:"20px",padding:"8px 16px",backgroundColor:"#f0f0f0",border:"none",borderRadius:"4px",cursor:"pointer"},children:"← 戻る"}),(0,i.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)"},children:[C.main_image_url&&i.jsx("img",{src:C.main_image_url,alt:C.event_name,style:{width:"100%",maxHeight:"300px",objectFit:"cover",borderRadius:"8px",marginBottom:"20px"}}),i.jsx("h1",{style:{fontSize:"24px",fontWeight:"bold",marginBottom:"16px"},children:C.event_name}),(0,i.jsxs)("div",{style:{fontSize:"16px",color:"#666",marginBottom:"20px",lineHeight:"1.6"},children:[(0,i.jsxs)("div",{style:{marginBottom:"8px"},children:["\uD83D\uDCC5 ",new Date(C.event_start_date).toLocaleDateString("ja-JP")," - ",new Date(C.event_end_date).toLocaleDateString("ja-JP")]}),(0,i.jsxs)("div",{style:{marginBottom:"8px"},children:["\uD83D\uDCCD ",C.venue_name,C.venue_city&&` (${C.venue_city})`]}),C.genre&&(0,i.jsxs)("div",{style:{marginBottom:"8px"},children:["\uD83C\uDFF7️ ",C.genre]})]}),C.lead_text&&i.jsx("div",{style:{fontSize:"16px",lineHeight:"1.6",marginBottom:"20px",padding:"16px",backgroundColor:"#f9f9f9",borderRadius:"8px"},children:C.lead_text}),i.jsx("button",{onClick:()=>I(C.id),style:{width:"100%",padding:"16px",backgroundColor:"#5DABA8",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer"},children:"このイベントに申し込む"})]})]}):(0,i.jsxs)("div",{style:{minHeight:"100vh",backgroundColor:"#f5f5f5",paddingBottom:"80px"},children:[(0,i.jsxs)("div",{style:{backgroundColor:"white",padding:"16px",borderBottom:"1px solid #e0e0e0",position:"sticky",top:0,zIndex:100},children:[i.jsx("h1",{style:{fontSize:"20px",fontWeight:"bold",marginBottom:"16px"},children:"イベント検索"}),(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[i.jsx("input",{type:"text",placeholder:"キーワード検索",value:x,onChange:e=>c(e.target.value),style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"16px"}}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"},children:[i.jsx("input",{type:"date",value:g,onChange:e=>u(e.target.value),style:{padding:"12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px"}}),i.jsx("input",{type:"date",value:h,onChange:e=>m(e.target.value),style:{padding:"12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px"}})]}),i.jsx("input",{type:"text",placeholder:"都道府県",value:f,onChange:e=>b(e.target.value),style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"16px"}}),i.jsx("input",{type:"text",placeholder:"市区町村",value:v,onChange:e=>S(e.target.value),style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"16px"}}),i.jsx("input",{type:"text",placeholder:"ジャンル",value:_,onChange:e=>w(e.target.value),style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"16px"}})]})]}),(0,i.jsxs)("div",{style:{padding:"20px"},children:[d&&i.jsx("div",{style:{padding:"16px",backgroundColor:"#fee",color:"#c33",borderRadius:"8px",marginBottom:"16px"},children:d}),0===r.length?(0,i.jsxs)("div",{style:{textAlign:"center",padding:"40px 20px",color:"#999"},children:[i.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"\uD83D\uDD0D"}),i.jsx("div",{style:{fontSize:"16px"},children:"条件に一致するイベントが見つかりませんでした"})]}):i.jsx("div",{style:{display:"grid",gap:"16px"},children:r.map(e=>i.jsx(j,{event:e,onClick:()=>D(e)},e.id))})]})]})}function _({exhibitor:e,onComplete:t,onCancel:r}){let[s,l]=(0,n.useState)(!1),[a,d]=(0,n.useState)(""),[p,x]=(0,n.useState)({name:e.name,gender:e.gender,age:e.age.toString(),phoneNumber:e.phone_number,email:e.email,genreCategory:e.genre_category||"",genreFreeText:e.genre_free_text||""}),[g,u]=(0,n.useState)({}),h=(e,t)=>{x(r=>({...r,[e]:t}))},m=(e,t)=>{u(r=>({...r,[e]:t}))},b=async r=>{r.preventDefault(),d(""),l(!0);try{let r={name:p.name,gender:p.gender,age:parseInt(p.age),phone_number:p.phoneNumber,email:p.email,genre_category:p.genreCategory||null,genre_free_text:p.genreFreeText||null};for(let t of["businessLicenseImage","vehicleInspectionImage","automobileInspectionImage","plInsuranceImage","fireEquipmentLayoutImage"]){let i=g[t];if(i){let n=`exhibitors/${e.id}/${t}_${Date.now()}.${i.name.split(".").pop()}`,o=await c("documents",n,i);r[t.replace("Image","ImageUrl").replace(/([A-Z])/g,"_$1").toLowerCase()]=o}}let{error:i}=await o.O.from("exhibitors").update(r).eq("id",e.id);if(i)throw i;t()}catch(e){d(e.message||"更新に失敗しました")}finally{l(!1)}};return s?i.jsx("div",{style:{padding:"20px"},children:i.jsx(y.Z,{})}):(0,i.jsxs)("div",{style:{minHeight:"100vh",backgroundColor:"#f5f5f5",paddingBottom:"80px"},children:[(0,i.jsxs)("div",{style:{backgroundColor:"white",padding:"16px",borderBottom:"1px solid #e0e0e0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h1",{style:{fontSize:"20px",fontWeight:"bold"},children:"プロフィール編集"}),i.jsx("button",{onClick:r,style:{padding:"8px 16px",backgroundColor:"#f0f0f0",border:"none",borderRadius:"4px",fontSize:"14px",cursor:"pointer"},children:"キャンセル"})]}),(0,i.jsxs)("div",{style:{padding:"20px"},children:[a&&i.jsx("div",{style:{padding:"12px",backgroundColor:"#fee",color:"#c33",borderRadius:"4px",marginBottom:"20px"},children:a}),i.jsx("form",{onSubmit:b,children:(0,i.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)"},children:[(0,i.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,i.jsxs)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:["名前 ",i.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),i.jsx("input",{type:"text",value:p.name,onChange:e=>h("name",e.target.value),required:!0,style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"16px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,i.jsxs)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:["性別 ",i.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),(0,i.jsxs)("select",{value:p.gender,onChange:e=>h("gender",e.target.value),required:!0,style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"16px"},children:[i.jsx("option",{value:"男",children:"男"}),i.jsx("option",{value:"女",children:"女"}),i.jsx("option",{value:"それ以外",children:"それ以外"})]})]}),(0,i.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,i.jsxs)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:["年齢 ",i.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),i.jsx("input",{type:"number",value:p.age,onChange:e=>h("age",e.target.value),required:!0,min:"0",style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"16px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,i.jsxs)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:["電話番号 ",i.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),i.jsx("input",{type:"tel",value:p.phoneNumber,onChange:e=>h("phoneNumber",e.target.value),required:!0,style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"16px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,i.jsxs)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:["メールアドレス ",i.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),i.jsx("input",{type:"email",value:p.email,onChange:e=>h("email",e.target.value),required:!0,style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"16px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"ジャンル（カテゴリ）"}),i.jsx("input",{type:"text",value:p.genreCategory,onChange:e=>h("genreCategory",e.target.value),style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"16px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"ジャンル（自由記述）"}),i.jsx("textarea",{value:p.genreFreeText,onChange:e=>h("genreFreeText",e.target.value),rows:4,style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"16px",fontFamily:"inherit"}})]}),(0,i.jsxs)("div",{style:{marginTop:"30px",paddingTop:"20px",borderTop:"1px solid #e0e0e0"},children:[i.jsx("h3",{style:{fontSize:"16px",fontWeight:"bold",marginBottom:"16px"},children:"書類画像（変更する場合のみ選択）"}),i.jsx(f,{label:"営業許可証",value:e.business_license_image_url,onFileSelect:e=>m("businessLicenseImage",e)}),i.jsx(f,{label:"車検証",value:e.vehicle_inspection_image_url,onFileSelect:e=>m("vehicleInspectionImage",e)}),i.jsx(f,{label:"自賠責保険",value:e.automobile_inspection_image_url,onFileSelect:e=>m("automobileInspectionImage",e)}),i.jsx(f,{label:"PL保険",value:e.pl_insurance_image_url,onFileSelect:e=>m("plInsuranceImage",e)}),i.jsx(f,{label:"消防設備配置図",value:e.fire_equipment_layout_image_url,onFileSelect:e=>m("fireEquipmentLayoutImage",e)})]}),i.jsx("button",{type:"submit",style:{width:"100%",padding:"16px",backgroundColor:"#5DABA8",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",marginTop:"20px"},children:"更新する"})]})})]})]})}function w(){let[e,t]=(0,n.useState)(null),[r,l]=(0,n.useState)(!0),[a,d]=(0,n.useState)(""),[p,x]=(0,n.useState)(!1);(0,n.useEffect)(()=>{c()},[]);let c=async()=>{try{l(!0);let e=await s();if(!e){d("ログインが必要です");return}let{data:r,error:i}=await o.O.from("exhibitors").select("*").eq("user_id",e.id).single();if(i)throw i;t(r)}catch(e){console.error("Error loading profile:",e),d(e.message||"プロフィールの読み込みに失敗しました")}finally{l(!1)}};return r?i.jsx("div",{style:{padding:"20px"},children:i.jsx(y.Z,{})}):a&&!e?i.jsx("div",{style:{padding:"20px",textAlign:"center"},children:i.jsx("div",{style:{padding:"16px",backgroundColor:"#fee",color:"#c33",borderRadius:"8px"},children:a})}):p&&e?i.jsx(_,{exhibitor:e,onComplete:()=>{x(!1),c()},onCancel:()=>x(!1)}):e?(0,i.jsxs)("div",{style:{minHeight:"100vh",backgroundColor:"#f5f5f5",paddingBottom:"80px"},children:[(0,i.jsxs)("div",{style:{backgroundColor:"white",padding:"16px",borderBottom:"1px solid #e0e0e0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h1",{style:{fontSize:"20px",fontWeight:"bold"},children:"プロフィール"}),i.jsx("button",{onClick:()=>x(!0),style:{padding:"8px 16px",backgroundColor:"#5DABA8",color:"white",border:"none",borderRadius:"4px",fontSize:"14px",cursor:"pointer"},children:"編集"})]}),i.jsx("div",{style:{padding:"20px"},children:(0,i.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)"},children:[(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[i.jsx("div",{style:{fontSize:"14px",color:"#999",marginBottom:"4px"},children:"名前"}),i.jsx("div",{style:{fontSize:"18px",fontWeight:"500"},children:e.name})]}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[i.jsx("div",{style:{fontSize:"14px",color:"#999",marginBottom:"4px"},children:"性別"}),i.jsx("div",{style:{fontSize:"18px"},children:e.gender})]}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[i.jsx("div",{style:{fontSize:"14px",color:"#999",marginBottom:"4px"},children:"年齢"}),(0,i.jsxs)("div",{style:{fontSize:"18px"},children:[e.age,"歳"]})]}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[i.jsx("div",{style:{fontSize:"14px",color:"#999",marginBottom:"4px"},children:"電話番号"}),i.jsx("div",{style:{fontSize:"18px"},children:e.phone_number})]}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[i.jsx("div",{style:{fontSize:"14px",color:"#999",marginBottom:"4px"},children:"メールアドレス"}),i.jsx("div",{style:{fontSize:"18px"},children:e.email})]}),e.genre_category&&(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[i.jsx("div",{style:{fontSize:"14px",color:"#999",marginBottom:"4px"},children:"ジャンル（カテゴリ）"}),i.jsx("div",{style:{fontSize:"18px"},children:e.genre_category})]}),e.genre_free_text&&(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[i.jsx("div",{style:{fontSize:"14px",color:"#999",marginBottom:"4px"},children:"ジャンル（自由記述）"}),i.jsx("div",{style:{fontSize:"18px",lineHeight:"1.6"},children:e.genre_free_text})]}),(0,i.jsxs)("div",{style:{marginTop:"30px",paddingTop:"20px",borderTop:"1px solid #e0e0e0"},children:[i.jsx("h3",{style:{fontSize:"16px",fontWeight:"bold",marginBottom:"16px"},children:"登録書類"}),e.business_license_image_url&&(0,i.jsxs)("div",{style:{marginBottom:"12px"},children:[i.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"8px"},children:"営業許可証"}),i.jsx("img",{src:e.business_license_image_url,alt:"営業許可証",style:{maxWidth:"100%",maxHeight:"200px",borderRadius:"4px"}})]}),e.vehicle_inspection_image_url&&(0,i.jsxs)("div",{style:{marginBottom:"12px"},children:[i.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"8px"},children:"車検証"}),i.jsx("img",{src:e.vehicle_inspection_image_url,alt:"車検証",style:{maxWidth:"100%",maxHeight:"200px",borderRadius:"4px"}})]}),e.automobile_inspection_image_url&&(0,i.jsxs)("div",{style:{marginBottom:"12px"},children:[i.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"8px"},children:"自賠責保険"}),i.jsx("img",{src:e.automobile_inspection_image_url,alt:"自賠責保険",style:{maxWidth:"100%",maxHeight:"200px",borderRadius:"4px"}})]}),e.pl_insurance_image_url&&(0,i.jsxs)("div",{style:{marginBottom:"12px"},children:[i.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"8px"},children:"PL保険"}),i.jsx("img",{src:e.pl_insurance_image_url,alt:"PL保険",style:{maxWidth:"100%",maxHeight:"200px",borderRadius:"4px"}})]}),e.fire_equipment_layout_image_url&&(0,i.jsxs)("div",{style:{marginBottom:"12px"},children:[i.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"8px"},children:"消防設備配置図"}),i.jsx("img",{src:e.fire_equipment_layout_image_url,alt:"消防設備配置図",style:{maxWidth:"100%",maxHeight:"200px",borderRadius:"4px"}})]})]})]})})]}):i.jsx("div",{style:{padding:"20px",textAlign:"center"},children:i.jsx("div",{style:{fontSize:"16px",color:"#999"},children:"プロフィール情報がありません"})})}function C(){let[e,t]=(0,n.useState)([]),[r,l]=(0,n.useState)([]),[a,d]=(0,n.useState)(!0),[p,x]=(0,n.useState)(""),[c,g]=(0,n.useState)("all");(0,n.useEffect)(()=>{u()},[]),(0,n.useEffect)(()=>{h()},[e,c]);let u=async()=>{try{d(!0);let e=await s();if(!e){x("ログインが必要です");return}let{data:r}=await o.O.from("exhibitors").select("id").eq("user_id",e.id).single();if(!r){x("出店者情報が登録されていません");return}let{data:i,error:n}=await o.O.from("event_applications").select(`
          *,
          event:events (
            id,
            event_name,
            event_start_date,
            event_end_date,
            venue_name,
            main_image_url
          )
        `).eq("exhibitor_id",r.id).order("applied_at",{ascending:!1});if(n)throw n;t(i||[])}catch(e){console.error("Error loading applications:",e),x(e.message||"申し込み履歴の読み込みに失敗しました")}finally{d(!1)}},h=()=>{"all"===c?l(e):l(e.filter(e=>e.application_status===c))},m=e=>{switch(e){case"pending":return"審査中";case"approved":return"承認済み";case"rejected":return"却下";default:return e}},f=e=>{switch(e){case"pending":return"#f39c12";case"approved":return"#27ae60";case"rejected":return"#e74c3c";default:return"#999"}};return a?i.jsx("div",{style:{padding:"20px"},children:i.jsx(y.Z,{})}):(0,i.jsxs)("div",{style:{minHeight:"100vh",backgroundColor:"#f5f5f5",paddingBottom:"80px"},children:[(0,i.jsxs)("div",{style:{backgroundColor:"white",padding:"16px",borderBottom:"1px solid #e0e0e0",position:"sticky",top:0,zIndex:100},children:[i.jsx("h1",{style:{fontSize:"20px",fontWeight:"bold",marginBottom:"16px"},children:"申し込み履歴"}),i.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:["all","pending","approved","rejected"].map(e=>i.jsx("button",{onClick:()=>g(e),style:{padding:"8px 16px",backgroundColor:c===e?"#5DABA8":"#f0f0f0",color:c===e?"white":"#333",border:"none",borderRadius:"4px",fontSize:"14px",cursor:"pointer"},children:"all"===e?"すべて":m(e)},e))})]}),(0,i.jsxs)("div",{style:{padding:"20px"},children:[p&&i.jsx("div",{style:{padding:"16px",backgroundColor:"#fee",color:"#c33",borderRadius:"8px",marginBottom:"16px"},children:p}),0===r.length?(0,i.jsxs)("div",{style:{textAlign:"center",padding:"40px 20px",color:"#999"},children:[i.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"\uD83D\uDCCB"}),i.jsx("div",{style:{fontSize:"16px"},children:"申し込み履歴がありません"})]}):i.jsx("div",{style:{display:"grid",gap:"16px"},children:r.map(e=>(0,i.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"8px",padding:"16px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.event.main_image_url&&i.jsx("img",{src:e.event.main_image_url,alt:e.event.event_name,style:{width:"100%",height:"150px",objectFit:"cover",borderRadius:"8px",marginBottom:"12px"}}),i.jsx("h3",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"8px"},children:e.event.event_name}),(0,i.jsxs)("div",{style:{fontSize:"14px",color:"#666",marginBottom:"12px"},children:["\uD83D\uDCC5 ",new Date(e.event.event_start_date).toLocaleDateString("ja-JP")," - ",new Date(e.event.event_end_date).toLocaleDateString("ja-JP")]}),(0,i.jsxs)("div",{style:{fontSize:"14px",color:"#666",marginBottom:"12px"},children:["\uD83D\uDCCD ",e.event.venue_name]}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("div",{children:i.jsx("span",{style:{padding:"4px 12px",backgroundColor:f(e.application_status),color:"white",borderRadius:"12px",fontSize:"12px",fontWeight:"500"},children:m(e.application_status)})}),i.jsx("div",{style:{fontSize:"12px",color:"#999"},children:new Date(e.applied_at).toLocaleDateString("ja-JP")})]})]},e.id))})]})]})}function z(){let[e,t]=(0,n.useState)([]),[r,l]=(0,n.useState)(0),[a,d]=(0,n.useState)(!0),[p,x]=(0,n.useState)("");(0,n.useEffect)(()=>{c();let e=setInterval(c,3e4);return()=>clearInterval(e)},[]);let c=async()=>{try{let e=await s();if(!e){d(!1);return}let{data:r,error:i}=await o.O.from("notifications").select("*").eq("user_id",e.id).eq("user_type","exhibitor").order("created_at",{ascending:!1}).limit(50);if(i)throw i;t(r||[]),l((r||[]).filter(e=>!e.is_read).length)}catch(e){console.error("Error loading notifications:",e),x(e.message||"通知の読み込みに失敗しました")}finally{d(!1)}},g=async e=>{try{let{error:r}=await o.O.from("notifications").update({is_read:!0}).eq("id",e);if(r)throw r;t(t=>t.map(t=>t.id===e?{...t,is_read:!0}:t)),l(e=>Math.max(0,e-1))}catch(e){console.error("Error marking notification as read:",e)}},u=async()=>{try{let e=await s();if(!e)return;let{error:r}=await o.O.from("notifications").update({is_read:!0}).eq("user_id",e.id).eq("user_type","exhibitor").eq("is_read",!1);if(r)throw r;t(e=>e.map(e=>({...e,is_read:!0}))),l(0)}catch(e){console.error("Error marking all as read:",e)}},h=e=>{e.is_read||g(e.id),e.related_event_id?window.location.href=`/event/${e.related_event_id}`:e.related_application_id&&(window.location.href="/applications")};return a?i.jsx("div",{style:{padding:"20px"},children:i.jsx(y.Z,{})}):(0,i.jsxs)("div",{style:{minHeight:"100vh",backgroundColor:"#f5f5f5",paddingBottom:"80px"},children:[(0,i.jsxs)("div",{style:{backgroundColor:"white",padding:"16px",borderBottom:"1px solid #e0e0e0",display:"flex",justifyContent:"space-between",alignItems:"center",position:"sticky",top:0,zIndex:100},children:[(0,i.jsxs)("h1",{style:{fontSize:"20px",fontWeight:"bold"},children:["通知",r>0&&i.jsx("span",{style:{marginLeft:"8px",padding:"2px 8px",backgroundColor:"#e74c3c",color:"white",borderRadius:"12px",fontSize:"12px"},children:r})]}),r>0&&i.jsx("button",{onClick:u,style:{padding:"8px 16px",backgroundColor:"#5DABA8",color:"white",border:"none",borderRadius:"4px",fontSize:"14px",cursor:"pointer"},children:"すべて既読にする"})]}),(0,i.jsxs)("div",{style:{padding:"20px"},children:[p&&i.jsx("div",{style:{padding:"16px",backgroundColor:"#fee",color:"#c33",borderRadius:"8px",marginBottom:"16px"},children:p}),0===e.length?(0,i.jsxs)("div",{style:{textAlign:"center",padding:"40px 20px",color:"#999"},children:[i.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"\uD83D\uDD14"}),i.jsx("div",{style:{fontSize:"16px"},children:"通知はありません"})]}):i.jsx("div",{style:{display:"grid",gap:"12px"},children:e.map(e=>(0,i.jsxs)("div",{onClick:()=>h(e),style:{backgroundColor:e.is_read?"white":"#f0f8ff",borderRadius:"8px",padding:"16px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",cursor:"pointer",borderLeft:e.is_read?"none":"4px solid #5DABA8"},children:[i.jsx("div",{style:{fontSize:"16px",fontWeight:"bold",marginBottom:"8px",color:e.is_read?"#666":"#333"},children:e.title}),i.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"8px",lineHeight:"1.5"},children:e.message}),i.jsx("div",{style:{fontSize:"12px",color:"#999"},children:new Date(e.created_at).toLocaleString("ja-JP")})]},e.id))})]})]})}function k(){let[e,t]=(0,n.useState)(null),[r,l]=(0,n.useState)(null),[a,d]=(0,n.useState)(!0),[x,c]=(0,n.useState)("home");(0,n.useEffect)(()=>{g();let{data:{subscription:e}}=o.O.auth.onAuthStateChange(async(e,r)=>{"SIGNED_OUT"!==e&&r?"SIGNED_IN"===e&&r&&await g():(t(null),l(null))});return()=>{e.unsubscribe()}},[]);let g=async()=>{try{d(!0);let{data:{session:e},error:r}=await o.O.auth.getSession();if(r||!e){t(null),l(null),d(!1);return}let i=await s();if(!i){t(null),l(null),d(!1);return}t(i);let{data:n,error:a}=await o.O.from("exhibitors").select("*").eq("user_id",i.id).single();a&&"PGRST116"!==a.code&&console.error("Error checking exhibitor:",a),l(n||null)}catch(e){console.error("Error checking auth:",e),t(null),l(null)}finally{d(!1)}};if(a)return i.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx(y.Z,{})});if(!e)return i.jsx(p,{});if(!r)return i.jsx(b,{});let[u,h]=(0,n.useState)(0);return(0,n.useEffect)(()=>{if(e){let t=async()=>{try{let{data:t,error:r}=await o.O.from("notifications").select("id").eq("user_id",e.id).eq("user_type","exhibitor").eq("is_read",!1);!r&&t&&h(t.length)}catch(e){console.error("Error loading unread count:",e)}};t();let r=setInterval(t,3e4);return()=>clearInterval(r)}},[e]),(0,i.jsxs)("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column"},children:[(()=>{switch(x){case"home":default:return i.jsx(v,{});case"search":return i.jsx(S,{});case"profile":return i.jsx(w,{});case"applications":return i.jsx(C,{});case"notifications":return i.jsx(z,{})}})(),(0,i.jsxs)("div",{style:{position:"fixed",bottom:0,left:0,right:0,backgroundColor:"white",borderTop:"1px solid #e0e0e0",display:"flex",justifyContent:"space-around",padding:"8px 0",zIndex:1e3},children:[(0,i.jsxs)("button",{onClick:()=>c("notifications"),style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",padding:"8px",border:"none",backgroundColor:"transparent",cursor:"pointer",color:"notifications"===x?"#5DABA8":"#666"},children:[(0,i.jsxs)("div",{style:{position:"relative"},children:[i.jsx("span",{style:{fontSize:"24px"},children:"\uD83D\uDD14"}),u>0&&i.jsx("span",{style:{position:"absolute",top:"-4px",right:"-8px",backgroundColor:"#e74c3c",color:"white",borderRadius:"10px",fontSize:"10px",padding:"2px 6px",minWidth:"18px",textAlign:"center"},children:u>99?"99+":u})]}),i.jsx("span",{style:{fontSize:"12px",marginTop:"4px"},children:"通知"})]}),(0,i.jsxs)("button",{onClick:()=>c("applications"),style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",padding:"8px",border:"none",backgroundColor:"transparent",cursor:"pointer",color:"applications"===x?"#5DABA8":"#666"},children:[i.jsx("span",{style:{fontSize:"24px"},children:"\uD83D\uDCCB"}),i.jsx("span",{style:{fontSize:"12px",marginTop:"4px"},children:"履歴"})]}),(0,i.jsxs)("button",{onClick:()=>c("search"),style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",padding:"8px",border:"none",backgroundColor:"transparent",cursor:"pointer",color:"search"===x?"#5DABA8":"#666"},children:[i.jsx("span",{style:{fontSize:"24px"},children:"\uD83D\uDD0D"}),i.jsx("span",{style:{fontSize:"12px",marginTop:"4px"},children:"検索"})]}),(0,i.jsxs)("button",{onClick:()=>c("profile"),style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",padding:"8px",border:"none",backgroundColor:"transparent",cursor:"pointer",color:"profile"===x?"#5DABA8":"#666"},children:[i.jsx("span",{style:{fontSize:"24px"},children:"\uD83D\uDC64"}),i.jsx("span",{style:{fontSize:"12px",marginTop:"4px"},children:"プロフィール"})]})]})]})}},3214:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>o,__esModule:()=>n,default:()=>s});let i=(0,r(1481).createProxy)(String.raw`/Users/mocky700/Desktop/デミセル/store/app/page.tsx`),{__esModule:n,$$typeof:o}=i,s=i.default}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[499,95,905,732],()=>r(8629));module.exports=i})();